{% assign ingredients = product.metafields.custom.featured_ingredients.value %}
{% assign section_id = 'section-' | append: section.id %}

{% if ingredients != blank %}
  <style>
    .{{ section_id }} {
        padding-top: {{ section.settings.padding_top_mobile }}px;
        padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
      }

    @media screen and (min-width: 768px) {
       .{{ section_id }} {
          padding-top: {{ section.settings.padding_top_desktop }}px;
          padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
      }
    }
  </style>

  {{ 'featured-ingredients.css' | asset_url | stylesheet_tag }}

  <section class="{{ section_id }} featured-ingredients{% if section.settings.width_option == 'page-width' %} page-width{% elsif section.settings.width_option == 'full_width' %} full-width{% endif %}">
    {% assign heading = product.metafields.custom.ingredient_title | default: section.settings.default_heading %}
    {% if heading != blank %}
      <h2
        class="featured-ingredients__subtitle {{ section.settings.heading_size }} {% if section.settings.text_transform != blank %}{{ section.settings.text_transform }}{% endif %} {% if section.settings.text_alignment != blank %}{{ section.settings.text_alignment }}{% endif %}">
        {{ heading }}
      </h2>
    {% endif %}
    <div class="featured-ingredients__wrapper">
      <div class="featured-ingredients__list">
        {% for ingredient in ingredients limit: section.settings.max_ingredients %}
          <div class="featured-ingredients__item">
            <div class="featured-ingredients">
              {% if ingredient.image != blank %}
                {{
                  ingredient.image
                  | image_url: width: auto, height: auto
                  | image_tag: class: 'featured-ingredients__image', alt: ingredient.name
                }}
              {% endif %}
            </div>
            <div class="featured-ingredients__content  {% if section.settings.content_alignment != blank %}{{ section.settings.content_alignment }}{% endif %}">
              <h3 class="featured-ingredients__name">{{ ingredient.name }}</h3>
              <p class="featured-ingredients__description">{{ ingredient.description }}</p>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </section>
{% endif %}

{% schema %}
{
  "name": "Featured Ingredients",
  "settings": [
    {
      "type": "select",
      "id": "width_option",
      "label": "Width Option",
      "default": "page-width",
      "options": [
        { "value": "page-width", "label": "Container" },
        { "value": "full_width", "label": "Full Width" }
      ]
    },
    {
      "type": "range",
      "id": "max_ingredients",
      "label": "Maximum Ingredients to Display",
      "default": 4,
      "min": 1,
      "max": 12,
      "step": 1
    },

    {
      "type": "header",
      "content": "Heading Settings"
    },
    {
      "type": "text",
      "id": "default_heading",
      "label": "Default Heading",
      "default": "Featured Ingredients"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        { "value": "h2", "label": "Small" },
        { "value": "h1", "label": "Medium" },
        { "value": "h0", "label": "Large" },
        { "value": "hxl", "label": "XL" },
        { "value": "hxxl", "label": "XXL" }
      ],
      "default": "h1",
      "label": "Section Heading"
    },
    {
      "type": "select",
      "id": "text_transform",
      "label": "Title Text Transform",
      "default": "uppercase",
      "options": [
        { "value": "uppercase", "label": "Uppercase" },
        { "value": "lowercase", "label": "Lowercase" },
        { "value": "capitalize", "label": "Capitalize" }
      ]
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Title Text Alignment",
      "default": "left",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },

    {
      "type": "header",
      "content": "Padding Settings"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "label": "Padding Top (Desktop)",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "label": "Padding Bottom (Desktop)",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Padding Top (Mobile)",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 30
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Padding Bottom (Mobile)",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 30
    },

    {
      "type": "header",
      "content": "Content & Card Settings"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "Content Text Alignment",
      "default": "left",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },
  ],
  "presets": [{ "name": "Featured Ingredients" }]
}
{% endschema %}
